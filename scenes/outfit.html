<!doctype html>
<html>
  <head>
    <script type="text/javascript" src="../libraries/p5.min.js"></script>
    <script type="text/javascript" src="../libraries/p5.play.js"></script>
    <style>
      html, body {
        overflow: hidden;
        margin: 0;
        padding: 0;
        background:white;
      }
    </style>
  </head>
  <body>
    <script type="text/javascript">
    
      /****
        SCENE 7: interactive dog outfit picker

        Arthur: greaser
        Merlin: poodle skirt

        ENHANCEMENTS:
          - make sure outfits don't land on dog sprints on load
          - create more abstract function => Dog class?
      ****/

      const canvas_height = 375;
      const canvas_width = 500;

      let arthur_img, merlin_img, arthur, merlin;
      let arthur_success, merlin_success;
      let greaser, skirt;

      function preload() {
        // nakie
        arthur_img = loadImage('../assets/img/13R_Arthur_naked.png');
        merlin_img = loadImage('../assets/img/13R_Merlin_naked.png');

        // clothed
        arthur_success = loadImage('../assets/img/13R_Arthur_jacket.png');
        merlin_success = loadImage('../assets/img/13R_Merlin_skirt.png');

        // clothing
        skirt_img = loadImage('../assets/img/13R_skirt.png');
        jacket_img = loadImage('../assets/img/13R_jacket.png');

        bg_img = loadImage('../assets/img/13R_dressing_room.jpg');
      }

      function setup() {
        createCanvas(canvas_width, canvas_height);

        // resize pngs
        arthur_img.resize(0, 200);
        merlin_img.resize(0, 160);
        arthur_success.resize(0, 200);
        merlin_success.resize(0, 160);

        // create sprite with image of dogs
        arthur = createSprite(100, height/2); 
        merlin = createSprite(width-100, height/2); 
        arthur.addImage(arthur_img);
        merlin.addImage(merlin_img);

        // greaser outfit
        // greaser = createSprite(random(0, width), random(0, height), 20, 80);
        // greaser.shapeColor = color(36, 31, 36);
        greaser = createSprite(300, 50, 100, height/2); 
        jacket_img.resize(0, 100);
        greaser.addImage(jacket_img);
        greaser.mouseActive = true; // track mouse state

        // skirt outfit
        // skirt = createSprite(random(0, width), random(0, height), 50, 30);
        // skirt.shapeColor = color(245, 103, 240);
        skirt = createSprite(200, 50, 100, height/2); 
        skirt_img.resize(0, 100);
        skirt.addImage(skirt_img);
        skirt.mouseActive = true; // track mouse state
      }

      function draw() {
        background(bg_img);

        // case: user clicks on greaser
        if (greaser.mouseIsOver && mouseIsPressed) {
          greaser.position.x = mouseX;
          greaser.position.y = mouseY;
        }

        // user clicks on skirt
        if (skirt.mouseIsOver && mouseIsPressed) {
          skirt.position.x = mouseX;
          skirt.position.y = mouseY;
        }

        greaser.overlap(arthur, ootoo);
        skirt.overlap(merlin, meemee);

        drawSprites();
      }

      function ootoo(greaser, arthur) {
        // snap outfit to dog
        greaser.position.x = arthur.position.x;
        greaser.position.y = arthur.position.y;

        // switch sprite to new image
        arthur.addImage(arthur_success);

        // remove outfit sprite
        greaser.remove();
      }
      
      function meemee(skirt, merlin) {
        // snap outfit to dog
        skirt.position.x = merlin.position.x;
        skirt.position.y = merlin.position.y;

        // switch sprite to new image
        merlin.addImage(merlin_success);

        // remove outfit sprite
        skirt.remove();
      }

    </script>
  </body>
</html>